<!DOCTYPE html>
<html>
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>æä¸æ˜ç™½çš„ Javascript é—­åŒ… | Z - Computer &amp; Programming Technology</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="google-adsense-account" content="ca-pub-8768699638326268">
  <meta name="description" content="åœ¨ Javascript è¯­è¨€ä¸­ï¼Œé—­åŒ…å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåªæ˜¯å®ƒä¸Šä¸‹æ–‡ä¸­çš„å˜é‡ä»¥å¼•ç”¨çš„å½¢å¼ä¸å…¶ç»‘å®šåœ¨äº†ä¸€èµ·ã€‚ 123456789function getMeAClosure() &amp;#123;  var canYouSeeMe &#x3D; &quot;here I am&quot;;  return (function theClosure() &amp;#123;    return &amp;#123;canYouSeeIt">
<meta property="og:type" content="article">
<meta property="og:title" content="æä¸æ˜ç™½çš„ Javascript é—­åŒ…">
<meta property="og:url" content="http://zvz.im/2016/09/03/understand-js-closure/index.html">
<meta property="og:site_name" content="Z - Computer &amp; Programming Technology">
<meta property="og:description" content="åœ¨ Javascript è¯­è¨€ä¸­ï¼Œé—­åŒ…å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåªæ˜¯å®ƒä¸Šä¸‹æ–‡ä¸­çš„å˜é‡ä»¥å¼•ç”¨çš„å½¢å¼ä¸å…¶ç»‘å®šåœ¨äº†ä¸€èµ·ã€‚ 123456789function getMeAClosure() &amp;#123;  var canYouSeeMe &#x3D; &quot;here I am&quot;;  return (function theClosure() &amp;#123;    return &amp;#123;canYouSeeIt">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2016-09-03T23:32:18.000Z">
<meta property="article:modified_time" content="2025-07-04T09:35:17.314Z">
<meta property="article:author" content="darluc">
<meta property="article:tag" content="javascript">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="Z - Computer &amp; Programming Technology" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link href="//fonts.geekzu.org/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
<link rel="stylesheet" href="/css/style.css">

  
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8NRBEZPWYN"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8NRBEZPWYN');
</script>


  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8768699638326268"
     crossorigin="anonymous"></script>
<meta name="generator" content="Hexo 6.3.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="container">
    <div id="wrap">
      <div class="outer">
        <section id="main"><article id="post-understand-js-closure" class="article article-type-post" itemscope itemprop="blogPost">
  
  <div class="article-inner">
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      æä¸æ˜ç™½çš„ Javascript é—­åŒ…
    </h1>
  

      </header>
    
    <div class="article-meta">
      <a href="/2016/09/03/understand-js-closure/" class="article-date">
  <time datetime="2016-09-03T23:32:18.000Z" itemprop="datePublished">2016-09-03</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/tags/javascript/">javascript</a>
  </div>

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>åœ¨ Javascript è¯­è¨€ä¸­ï¼Œé—­åŒ…å°±æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œåªæ˜¯å®ƒä¸Šä¸‹æ–‡ä¸­çš„å˜é‡ä»¥å¼•ç”¨çš„å½¢å¼ä¸å…¶ç»‘å®šåœ¨äº†ä¸€èµ·ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getMeAClosure</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> canYouSeeMe = <span class="string">&quot;here I am&quot;</span>;</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">function</span> <span class="title function_">theClosure</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="attr">canYouSeeIt</span>: canYouSeeMe ? <span class="string">&quot;yes&quot;</span> : <span class="string">&quot;no&quot;</span>&#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> closure = <span class="title function_">getMeAClosure</span>();</span><br><span class="line"><span class="title function_">closure</span>().<span class="property">canYouSeeIt</span>; <span class="comment">//&quot;yes&quot;</span></span><br></pre></td></tr></table></figure>
<p>å®é™…ä¸Šæ¯ä¸ª Javascript å‡½æ•°åœ¨ç”Ÿæˆçš„æ—¶å€™éƒ½å½¢æˆäº†é—­åŒ…ã€‚ç¨åæˆ‘ä¼šç»™å¤§å®¶è§£é‡Šé—­åŒ…çš„äº§ç”ŸåŸå› å’Œè¿‡ç¨‹ï¼Œç„¶åçº æ­£ä¸€äº›å…³äºé—­åŒ…çš„é”™è¯¯æ¦‚å¿µï¼Œæœ€åå†ç»™å‡ºä¸€äº›é—­åŒ…çš„å®é™…ç”¨ä¾‹ã€‚ä¸è¿‡é¦–å…ˆç®€å•ä»‹ç»ä¸€ä¸‹é—­åŒ…ç›¸å…³çš„åŸºç¡€æ¦‚å¿µï¼šJavascript çš„é—­åŒ…æ˜¯é€šè¿‡ <code>è¯æ³•åŸŸ (lexical scope)</code> å’Œ <code>å˜é‡ç¯å¢ƒ (VariableEnvironment)</code> å®ç°çš„ã€‚<br><span id="more"></span></p>
<h2 id="è¯æ³•åŸŸï¼ˆ-Lexical-Scope-ï¼‰"><a href="#è¯æ³•åŸŸï¼ˆ-Lexical-Scope-ï¼‰" class="headerlink" title="è¯æ³•åŸŸï¼ˆ Lexical Scope ï¼‰"></a>è¯æ³•åŸŸï¼ˆ Lexical Scope ï¼‰</h2><p>â€œè¯æ³•â€è¿™ä¸ªè¯ä¸€èˆ¬éƒ½æ˜¯è¯­è¨€ç›¸å…³ã€‚æ‰€ä»¥å‡½æ•°çš„è¯æ³•åŸŸæ˜¯é™æ€çš„ï¼Œæ˜¯ç”±å‡½æ•°ä»£ç åœ¨æºä»£ç ä¸­çš„ä½ç½®å†³å®šçš„ã€‚</p>
<p>å‚è€ƒä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="string">&quot;global&quot;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">outer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> y = <span class="string">&quot;outer&quot;</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">inner</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="string">&quot;inner&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å‡½æ•° <code>inner</code> åœ¨ä»£ç ä¸­è¢«å‡½æ•° <code>outer</code> åŒ…è£¹ç€ï¼Œè€Œ <code>outer</code> åˆè¢«å…¨å±€ä¸Šä¸‹æ–‡åŒ…å«åœ¨å†…ã€‚è¿™æ ·å°±å½¢æˆäº†ä¸€ä¸ªè¯æ³•ç»§æ‰¿å…³ç³»ï¼š</p>
<p>global</p>
<p>â€” outer</p>
<p>â€”â€” inner</p>
<p>æ¯ä¸ªå‡½æ•°çš„å¤–éƒ¨è¯æ³•åŸŸéƒ½æ˜¯ç”±è¯æ³•ç»§æ‰¿å…³ç³»ä¸­å®ƒçš„ç¥–å…ˆå†³å®šçš„ã€‚å› æ­¤ï¼Œ<code>inner</code> å‡½æ•°çš„å¤–éƒ¨è¯æ³•åŸŸå°±æ˜¯ç”±å…¨å±€å¯¹è±¡å’Œå‡½æ•° <code>outer</code> ç»„æˆçš„ã€‚</p>
<h2 id="å˜é‡ç¯å¢ƒï¼ˆ-VariableEnvironment-ï¼‰"><a href="#å˜é‡ç¯å¢ƒï¼ˆ-VariableEnvironment-ï¼‰" class="headerlink" title="å˜é‡ç¯å¢ƒï¼ˆ VariableEnvironment ï¼‰"></a>å˜é‡ç¯å¢ƒï¼ˆ VariableEnvironment ï¼‰</h2><p>å…¨å±€å¯¹è±¡æœ‰ä¸€ä¸ªç›¸å…³çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚è€Œä¸”æ¯ä¸€æ¬¡å‡½æ•°è°ƒç”¨ä¹Ÿä¼šå»ºç«‹å¹¶è¿›å…¥ä¸€ä¸ªæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€‚è¿™ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ç›¸å¯¹äºé™æ€çš„è¯æ³•åŸŸæ˜¯åŠ¨æ€ç”Ÿæˆçš„ã€‚æ¯ä¸€ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡éƒ½ç¡®å®šäº†ä¸€ä¸ªå˜é‡ç¯å¢ƒï¼Œå®ƒæ˜¯åœ¨è¯¥ä¸Šä¸‹æ–‡ä¸­æ‰€å£°æ˜å˜é‡çš„å®¹å™¨ã€‚ï¼ˆ<a target="_blank" rel="noopener" href="http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-262.pdf">ES 5</a> 10.4ï¼Œ10.5ï¼‰</p>
<blockquote>
<p>æ³¨æ„ï¼Œåœ¨ EcmaScript 3 ä¸­ï¼Œå‡½æ•°çš„å˜é‡ç¯å¢ƒï¼ˆ VariableEnvironment ï¼‰è¢«ç§°ä¸ºæ´»åŠ¨å¯¹è±¡ï¼ˆ ActivationObject ï¼‰</p>
</blockquote>
<p>ä»¥ä¸‹ä¼ªä»£ç å¯ä»¥ç”¨æ¥æè¿°å˜é‡ç¯å¢ƒ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//variableEnvironment: &#123;x: undefined, etc.&#125;;</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="string">&quot;global&quot;</span></span><br><span class="line"><span class="comment">//variableEnvironment: &#123;x: &quot;global&quot;, etc.&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">outer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">//variableEnvironment: &#123;y: undefined&#125;;</span></span><br><span class="line">  <span class="keyword">var</span> y = <span class="string">&quot;outer&quot;</span>;</span><br><span class="line">  <span class="comment">//variableEnvironment: &#123;y: &quot;outer&quot;&#125;;</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">inner</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//variableEnviroment: &#123;x: undefined&#125;;</span></span><br><span class="line">    <span class="keyword">var</span> x = <span class="string">&quot;inner&quot;</span>;</span><br><span class="line">    <span class="comment">//variableEnvironment: &#123;x: &quot;inner&quot;&#125;;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸è¿‡ï¼Œè¿™åªæè¿°äº†æ•´ä¸ªå›¾æ™¯ä¸­çš„ä¸€éƒ¨åˆ†ã€‚æ¯ä¸ªå˜é‡ç¯å¢ƒéƒ½ä¼šç»§æ‰¿å®ƒæ‰€å±è¯æ³•åŸŸçš„å˜é‡ç¯å¢ƒã€‚</p>
<h2 id="scope-å±æ€§"><a href="#scope-å±æ€§" class="headerlink" title="[[scope]]å±æ€§"></a>[[scope]]å±æ€§</h2><p>å½“ä¸€ä¸ªå‡½æ•°å®šä¹‰è¿‡ç¨‹å‘ç”Ÿåœ¨æŸä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ç¯å¢ƒä¸­æ—¶ï¼Œä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„å‡½æ•°å¯¹è±¡ï¼Œæ­¤å‡½æ•°å¯¹è±¡ä¼šåŒ…å«ä¸€ä¸ªåä¸º [[scope]] çš„å†…éƒ¨å±æ€§å¼•ç”¨å½“å‰çš„å˜é‡ç¯å¢ƒã€‚ï¼ˆ<a target="_blank" rel="noopener" href="http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-262.pdf">ES 5</a> 13.0-2ï¼‰</p>
<p>æ¯ä¸ªå‡½æ•°éƒ½æœ‰è¿™æ ·ä¸€ä¸ª [[scope]] å±æ€§ï¼Œè€Œä¸”å½“å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œè¿™ä¸ª [[scope]] å±æ€§ä¼šè¢«èµ‹å€¼ç»™å˜é‡ç¯å¢ƒçš„ <em>outerLex</em> å±æ€§ï¼Œè¯¥å±æ€§æ˜¯å¯¹å¤–å±‚è¯æ³•ç¯å¢ƒçš„å¼•ç”¨ï¼ˆ outer lexical environment reference ç®€å†™ä¸º outerLex ï¼‰ã€‚è¿™æ ·ä¸€æ¥ï¼Œæ¯ä¸ªå˜é‡ç¯å¢ƒéƒ½ç»§æ‰¿äº†å®ƒçˆ¶çº§çš„å˜é‡ç¯å¢ƒã€‚è¿™ä¸ª [[scope]] é“¾ä¼šä¸€ç›´å»¶ä¼¸è‡³å…¨å±€å¯¹è±¡ï¼Œä¸è¯æ³•ç»§æ‰¿çš„é•¿åº¦ä¸€æ ·ã€‚</p>
<p>ç°åœ¨è®©æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹ä¼ªä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//VariableEnvironment: &#123;x: undefined, etc.&#125;;</span></span><br><span class="line"><span class="keyword">var</span> x = <span class="string">&quot;global&quot;</span>;</span><br><span class="line"><span class="comment">//VariableEnvironment: &#123;x: &quot;global&quot;, etc.&#125;;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">outer</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">//VariableEnvironment:&#123;y: undefined, outerLex: &#123;x: &quot;global&quot;, etc.&#125;&#125;;</span></span><br><span class="line">  <span class="keyword">var</span> y = <span class="string">&quot;outer&quot;</span>;</span><br><span class="line">  <span class="comment">//VariableEnvironment: &#123;y: &quot;outer&quot;, outerLex: &#123;x: &quot;global&quot;, etc.&#125;&#125;;</span></span><br><span class="line">  </span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">inner</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//VariableEnvironment: &#123;x: undefined, outerLex: &#123;y: &quot;outer&quot;, outerLex: &#123;x:&quot;global&quot;, etc.&#125;&#125;;</span></span><br><span class="line">    <span class="keyword">var</span> x = <span class="string">&quot;inner&quot;</span>;</span><br><span class="line">    <span class="comment">//VariableEnvironment: &#123;x: &quot;inner&quot;, outerLex: &#123;y: &quot;outer&quot;, outerLex: &#123;x:&quot;global&quot;, etc.&#125;&#125;;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯¹äºå±‚å±‚åµŒå¥—çš„å˜é‡ç¯å¢ƒæ¥è¯´ï¼Œ[[scope]] å±æ€§èµ·åˆ°äº†æ¡¥æ¥çš„ä½œç”¨ï¼Œä½¿å¾—å¤–å±‚å˜é‡è¢«åµŒå…¥åˆ°å†…å±‚çš„å˜é‡ç¯å¢ƒä¸­ï¼ˆå¹¶ä¸”è®¿é—®ä¼˜å…ˆçº§ä¸è¯æ³•æ¥è¿‘ç¨‹åº¦ä¸€è‡´ï¼‰ã€‚[[scope]] å±æ€§è¿˜æˆå…¨äº†é—­åŒ…ï¼Œå› ä¸ºå‡å¦‚æ²¡æœ‰å®ƒçš„è¯ï¼Œå½“å¤–å±‚å‡½æ•°è¿”å›æ—¶ï¼Œå‡½æ•°ä¸­çš„å˜é‡å°±ä¼šè¢«è§£é™¤å¼•ç”¨è€Œè¢«å½“ä½œåƒåœ¾å›æ”¶ã€‚</p>
<p>è¿™å„¿å°±æ˜¯æ‰€è°“çš„é—­åŒ…å‡ºç°çš„åœ°æ–¹ï¼Œå®ƒåªä¸è¿‡æ˜¯è¯æ³•åŸŸä½œç”¨ï¼ˆlexical scopingï¼‰æ—¶äº§ç”Ÿçš„å‰¯ä½œç”¨è€Œå·²ğŸ˜‰</p>
<h2 id="è¾Ÿè°£"><a href="#è¾Ÿè°£" class="headerlink" title="è¾Ÿè°£"></a>è¾Ÿè°£</h2><p>æ—¢ç„¶çŸ¥é“äº†é—­åŒ…æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹çº æ­£ä¸€äº›å…³äºé—­åŒ…çš„é”™è¯¯ç†è§£äº†ã€‚</p>
<h3 id="é”™è¯¯1-é—­åŒ…æ˜¯åœ¨ä¸€ä¸ªå†…å±‚å‡½æ•°ä½œä¸ºç»“æœè¿”å›åæ‰ç”Ÿæˆçš„"><a href="#é”™è¯¯1-é—­åŒ…æ˜¯åœ¨ä¸€ä¸ªå†…å±‚å‡½æ•°ä½œä¸ºç»“æœè¿”å›åæ‰ç”Ÿæˆçš„" class="headerlink" title="é”™è¯¯1. é—­åŒ…æ˜¯åœ¨ä¸€ä¸ªå†…å±‚å‡½æ•°ä½œä¸ºç»“æœè¿”å›åæ‰ç”Ÿæˆçš„"></a>é”™è¯¯1. é—­åŒ…æ˜¯åœ¨ä¸€ä¸ªå†…å±‚å‡½æ•°ä½œä¸ºç»“æœè¿”å›åæ‰ç”Ÿæˆçš„</h3><p>å½“ä¸€ä¸ªå‡½æ•°è¢«åˆ›å»ºæ—¶ï¼Œå°±è¢«èµ‹äºˆäº† [[scope]] å±æ€§ï¼Œè¯¥å±æ€§å¼•ç”¨äº†å¤–å±‚è¯­æ³•åŸŸä¸­çš„å˜é‡å¹¶é˜²æ­¢å®ƒä»¬è¢«å›æ”¶ã€‚æ‰€ä»¥é—­åŒ…æ˜¯åœ¨å‡½æ•°åˆ›å»ºæ—¶å°±ç”Ÿæˆçš„ã€‚</p>
<p>å¹¶ä¸æ˜¯è¯´ä¸€ä¸ªå‡½æ•°å¿…é¡»åœ¨å®ƒè¢«è¿”å›ä¹‹åæ‰æˆä¸ºé—­åŒ…ã€‚ä»¥ä¸‹å°±æ˜¯ä¸€ä¸ªå‡½æ•°æ²¡æœ‰è¢«è¿”å›å´æ˜¯ä¸€ä¸ªé—­åŒ…çš„ä¾‹å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> callLater = <span class="keyword">function</span>(<span class="params">fn, args, context</span>) &#123;</span><br><span class="line">  <span class="title function_">setTimetout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;fn.<span class="title function_">apply</span>(context, args)&#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">callLater</span>(alert, [<span class="string">&#x27;hello&#x27;</span>]);</span><br></pre></td></tr></table></figure>
<h3 id="é”™è¯¯2-å¤–å±‚å˜é‡çš„å€¼ä¼šè¢«å¤åˆ¶æˆ–å›ºåŒ–åœ¨é—­åŒ…ä¸­"><a href="#é”™è¯¯2-å¤–å±‚å˜é‡çš„å€¼ä¼šè¢«å¤åˆ¶æˆ–å›ºåŒ–åœ¨é—­åŒ…ä¸­" class="headerlink" title="é”™è¯¯2. å¤–å±‚å˜é‡çš„å€¼ä¼šè¢«å¤åˆ¶æˆ–å›ºåŒ–åœ¨é—­åŒ…ä¸­"></a>é”™è¯¯2. å¤–å±‚å˜é‡çš„å€¼ä¼šè¢«å¤åˆ¶æˆ–å›ºåŒ–åœ¨é—­åŒ…ä¸­</h3><p>å¦‚ä¸‹ä¾‹æ‰€è§ï¼Œé—­åŒ…ä¼šå¼•ç”¨å˜é‡è€Œä¸æ˜¯å˜é‡çš„å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Bad Example</span></span><br><span class="line"><span class="comment">//Create an array of functions that add 1,2 and 3 respectively</span></span><br><span class="line"><span class="keyword">var</span> createAdders = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> fns = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i ++) &#123;</span><br><span class="line">    fns[i] = (<span class="keyword">function</span>(<span class="params">n</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> i + n;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> fns;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> adders = <span class="title function_">createAdders</span>();</span><br><span class="line">adders[<span class="number">1</span>](<span class="number">7</span>); <span class="comment">//11 ??</span></span><br><span class="line">adders[<span class="number">2</span>](<span class="number">7</span>); <span class="comment">//11 ??</span></span><br><span class="line">adders[<span class="number">3</span>](<span class="number">7</span>); <span class="comment">//11 ??</span></span><br></pre></td></tr></table></figure>
<p>è¿™ä¸‰ä¸ªåŠ æ•°å‡½æ•°éƒ½å¼•ç”¨äº†åŒä¸€ä¸ªå˜é‡ <em>i</em> ã€‚ç­‰åˆ°ä¸‰ä¸ªå‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œ<em>i</em> çš„å€¼å·²ç»æ˜¯ 4 äº†ã€‚</p>
<p>æœ‰ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯é€šè¿‡è°ƒç”¨åŒ¿åå‡½æ•°ä¼ é€’æ¯ä¸ªå‚æ•°ã€‚ç”±äºæ¯æ¬¡å‡½æ•°è°ƒç”¨éƒ½å‘ç”Ÿåœ¨ä¸€ä¸ªç‹¬ç«‹çš„æ‰§è¡Œä¸Šä¸‹æ–‡ä¸­ï¼Œå³ä½¿è¿ç»­è°ƒç”¨ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä¿è¯å‚æ•°å˜é‡çš„å”¯ä¸€æ€§ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Good Example</span></span><br><span class="line"><span class="comment">//Create an array of functions add 1,2 and 3 respectively</span></span><br><span class="line"><span class="keyword">var</span> createAdders = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> fns = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">1</span>; i &lt; <span class="number">4</span>; i ++) &#123;</span><br><span class="line">    (<span class="keyword">function</span>(<span class="params">i</span>)&#123;</span><br><span class="line">      fns[i] = (<span class="keyword">function</span>(<span class="params">n</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> i + n;</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;)(i)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> fns;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> adders = <span class="title function_">createAdders</span>();</span><br><span class="line">adders[<span class="number">1</span>](<span class="number">7</span>); <span class="comment">//8 :-)</span></span><br><span class="line">adders[<span class="number">2</span>](<span class="number">7</span>); <span class="comment">//9 :-)</span></span><br><span class="line">adders[<span class="number">3</span>](<span class="number">7</span>); <span class="comment">//10 :-)</span></span><br></pre></td></tr></table></figure>
<h3 id="é”™è¯¯3-é—­åŒ…ä¸€å®šæ˜¯å†…å±‚å‡½æ•°"><a href="#é”™è¯¯3-é—­åŒ…ä¸€å®šæ˜¯å†…å±‚å‡½æ•°" class="headerlink" title="é”™è¯¯3. é—­åŒ…ä¸€å®šæ˜¯å†…å±‚å‡½æ•°"></a>é”™è¯¯3. é—­åŒ…ä¸€å®šæ˜¯å†…å±‚å‡½æ•°</h3><p>ä¸å¯å¦è®¤å¤–å±‚å‡½æ•°æ‰€åˆ›å»ºçš„é—­åŒ…æ¯«æ— æ„æ€ï¼Œå› ä¸ºå®ƒçš„ [[scope]] å±æ€§åªæ˜¯å¼•ç”¨äº†å…¨å±€å˜é‡åŸŸè€Œå·²ï¼Œåœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½æ˜¯å¯ä»¥è®¿é—®åˆ°çš„ã€‚å¯¹äºæ¯ä¸ªå‡½æ•°æ¥è¯´é—­åŒ…çš„äº§ç”Ÿè¿‡ç¨‹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè€Œä¸”æ¯ä¸ªå‡½æ•°éƒ½ä¼šäº§ç”Ÿé—­åŒ…ï¼Œè®°ä½è¿™ç‚¹å¾ˆé‡è¦ã€‚</p>
<h3 id="é”™è¯¯4-é—­åŒ…ä¸€å®šæ˜¯åŒ¿åå‡½æ•°"><a href="#é”™è¯¯4-é—­åŒ…ä¸€å®šæ˜¯åŒ¿åå‡½æ•°" class="headerlink" title="é”™è¯¯4. é—­åŒ…ä¸€å®šæ˜¯åŒ¿åå‡½æ•°"></a>é”™è¯¯4. é—­åŒ…ä¸€å®šæ˜¯åŒ¿åå‡½æ•°</h3><p>æˆ‘åœ¨è®¸å¤šæ–‡ç« é‡Œçœ‹åˆ°è¿‡è¿™ç§è¯´æ³•ã€‚æ‚²å“€ï¼å®åœ¨æ˜¯æ‚²å“€ï¼ğŸ˜‰</p>
<h3 id="é”™è¯¯5-é—­åŒ…ä¼šå¯¼è‡´å†…å­˜æ³„æ¼"><a href="#é”™è¯¯5-é—­åŒ…ä¼šå¯¼è‡´å†…å­˜æ³„æ¼" class="headerlink" title="é”™è¯¯5. é—­åŒ…ä¼šå¯¼è‡´å†…å­˜æ³„æ¼"></a>é”™è¯¯5. é—­åŒ…ä¼šå¯¼è‡´å†…å­˜æ³„æ¼</h3><p>é—­åŒ…æœ¬èº«å¹¶ä¸ä¼šäº§ç”Ÿå¾ªç¯å¼•ç”¨ã€‚åœ¨æ–‡ç« å¼€å¤´çš„ä¾‹å­ä¸­ï¼Œ<code>inner</code> å‡½æ•°é€šè¿‡å®ƒçš„ [[scope]] å±æ€§å¼•ç”¨äº†å¤–å±‚å˜é‡ï¼Œä½†æ˜¯å¤–å±‚å˜é‡å’Œ <code>outer</code> å‡½æ•°éƒ½æ²¡æœ‰å¼•ç”¨ <code>inner</code> å‡½æ•°æˆ–å…¶å†…éƒ¨å˜é‡ã€‚</p>
<p>è€ç‰ˆæœ¬çš„ IE æµè§ˆå™¨å› å†…å­˜æ³„æ¼è€Œå£°åç‹¼è—‰ï¼Œé—­åŒ…å´æ›¿å®ƒèƒŒäº†é”…ã€‚ä¸€ä¸ªå…¸å‹çš„èµ·å› æ˜¯ï¼Œä¸€ä¸ª DOM å…ƒç´ è¢«å‡½æ•°å¼•ç”¨ï¼ŒåŒæ—¶è¿™ä¸ª DOM å…ƒç´ çš„ä¸€ä¸ªå±æ€§å¼•ç”¨äº†æ­¤å‡½æ•°è¯æ³•åŸŸä¸­çš„å¦ä¸€ä¸ªå¯¹è±¡ã€‚ä» IE6 å‘å±•åˆ° IE8 è¿™ç±»å¾ªç¯å¼•ç”¨é—®é¢˜ç»å¤§å¤šæ•°éƒ½å·²ç»è¢«è§£å†³äº†ã€‚</p>
<h2 id="ç»å…¸ç”¨ä¾‹"><a href="#ç»å…¸ç”¨ä¾‹" class="headerlink" title="ç»å…¸ç”¨ä¾‹"></a>ç»å…¸ç”¨ä¾‹</h2><h3 id="å‡½æ•°æ¨¡ç‰ˆ"><a href="#å‡½æ•°æ¨¡ç‰ˆ" class="headerlink" title="å‡½æ•°æ¨¡ç‰ˆ"></a>å‡½æ•°æ¨¡ç‰ˆ</h3><p>æœ‰æ—¶æˆ‘ä»¬æƒ³è¦å®šä¹‰ä¸€ä¸ªå‡½æ•°çš„å¤šä¸ªç‰ˆæœ¬ï¼Œæ¯ä¸ªç‰ˆæœ¬éƒ½éµä»åŒä¸€ä¸ªè“å›¾ï¼Œå´èƒ½æ ¹æ®æä¾›çš„å‚æ•°äº§ç”Ÿä¸åŒçš„å˜åŒ–ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€å¥—æ ‡å‡†çš„åº¦é‡å•ä½è½¬æ¢å‡½æ•°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">makeConverter</span>(<span class="params">toUnit, factor, offset</span>) &#123;</span><br><span class="line">  offset = offset || <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">input</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> [((offset + input) * factor).<span class="title function_">toFixed</span>(<span class="number">2</span>), toUnit].<span class="title function_">join</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> milesToKm = <span class="title function_">makeConverter</span>(<span class="string">&#x27;km&#x27;</span>, <span class="number">1.60936</span>);</span><br><span class="line"><span class="keyword">var</span> poundsToKg = <span class="title function_">makeConverter</span>(<span class="string">&#x27;kg&#x27;</span>, <span class="number">0.45460</span>);</span><br><span class="line"><span class="keyword">var</span> farenheitToCelsius = <span class="title function_">makeConverter</span>(<span class="string">&#x27;degree C&#x27;</span>, <span class="number">0.5556</span>, -<span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">milesToKm</span>(<span class="number">10</span>); <span class="comment">//&quot;16.09 km&quot;</span></span><br><span class="line"><span class="title function_">poundsToKg</span>(<span class="number">2.5</span>); <span class="comment">//&quot;1.14 kg&quot;</span></span><br><span class="line"><span class="title function_">farenheitToCelsius</span>(<span class="number">98</span>); <span class="comment">//&quot;36.67 degrees C&quot;</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœå’Œæˆ‘ä¸€æ ·ï¼Œä½ å–œæ¬¢å‡½æ•°å¼æŠ½è±¡ï¼Œé‚£ä¹ˆå†æ·±å…¥ä¸€æ­¥å°±æ˜¯è¿›è¡Œå‡½æ•°å‚æ•°çš„å¢é‡ç»‘å®šï¼ˆ<a target="_blank" rel="noopener" href="https://javascriptweblog.wordpress.com/2010/04/05/curry-cooking-up-tastier-functions/">currify</a>ï¼‰äº†ã€‚</p>
<h3 id="å‡½æ•°å¼-Javascriptï¼ˆFunctional-Javascriptï¼‰"><a href="#å‡½æ•°å¼-Javascriptï¼ˆFunctional-Javascriptï¼‰" class="headerlink" title="å‡½æ•°å¼ Javascriptï¼ˆFunctional Javascriptï¼‰"></a>å‡½æ•°å¼ Javascriptï¼ˆFunctional Javascriptï¼‰</h3><p>é™¤å»å‡½æ•°â€”â€”è¿™ä¸ªJavascript ä¸­ç¬¬ä¸€çº§åˆ«çš„å¯¹è±¡å¤–ï¼Œå‡½æ•°å¼ Javascript æœ€å¥½çš„ä¼™ä¼´å°±æ˜¯é—­åŒ…äº†ã€‚</p>
<p>bind, <a target="_blank" rel="noopener" href="https://javascriptweblog.wordpress.com/2010/04/05/curry-cooking-up-tastier-functions/">curry</a>, <a target="_blank" rel="noopener" href="https://javascriptweblog.wordpress.com/2010/05/17/partial-currys-flashy-cousin/">partial</a> å’Œ <a target="_blank" rel="noopener" href="https://javascriptweblog.wordpress.com/2010/04/14/compose-functions-as-building-blocks/">compose</a> çš„å…¸å‹å®ç°æ–¹å¼ï¼Œéƒ½ä¾èµ–äºé—­åŒ…ä¸ºæ–°å‡½æ•°æä¾›åŸå§‹å‡½æ•°åŠå‚æ•°çš„å¼•ç”¨ã€‚</p>
<p>å¦‚ä¸‹ä¾‹çš„ curry ï¼ˆå‚æ•°å¢é‡ç»‘å®šï¼‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">curry</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">arguments</span>.<span class="property">length</span> &lt; <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>; <span class="comment">//nothing to curry with - return function</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">var</span> __method = <span class="variable language_">this</span>;</span><br><span class="line">  <span class="keyword">var</span> args = <span class="title function_">toArray</span>(<span class="variable language_">arguments</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> __method.<span class="title function_">apply</span>(<span class="variable language_">this</span>, args.<span class="title function_">concat</span>([].<span class="property">slice</span>.<span class="title function_">apply</span>(<span class="literal">null</span>, <span class="variable language_">arguments</span>)));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ç”¨ curry çš„æ–¹å¼é‡å†™ä¸Šé¢çš„ä¾‹å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">converter</span>(<span class="params">toUnit, factor, offset, input</span>) &#123;</span><br><span class="line">  offset = offset || <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> [((offset + input) * factor).<span class="title function_">toFixed</span>(<span class="number">2</span>), toUnit].<span class="title function_">join</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> milesToKm = converter.<span class="title function_">curry</span>(<span class="string">&#x27;km&#x27;</span>, <span class="number">1.60936</span>, <span class="literal">undefined</span>);</span><br><span class="line"><span class="keyword">var</span> poundsToKg = converter.<span class="title function_">curry</span>(<span class="string">&#x27;kg&#x27;</span>, <span class="number">0.45460</span>, <span class="literal">undefined</span>);</span><br><span class="line"><span class="keyword">var</span> farenheitToCelsius = converter.<span class="title function_">curry</span>(<span class="string">&#x27;degrees C&#x27;</span>, <span class="number">0.5556</span>, -<span class="number">32</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_">milesToKm</span>(<span class="number">10</span>); <span class="comment">//&quot;16.09 km&quot;</span></span><br><span class="line"><span class="title function_">poundsToKg</span>(<span class="number">2.5</span>); <span class="comment">//&quot;1.14 kg&quot;</span></span><br><span class="line"><span class="title function_">farenheitToCelsius</span>(<span class="number">98</span>); <span class="comment">//&quot;36.67 degrees C&quot;</span></span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰è®¸å¤šå¾ˆæ¼‚äº®çš„å‡½æ•°è°ƒèŠ‚å™¨ï¼ˆmodifierï¼‰ä¹Ÿæ˜¯åˆ©ç”¨é—­åŒ…å®ç°çš„ã€‚ä¸‹é¢è¿™ä¸ªå¦‚å®çŸ³èˆ¬æ¼‚äº®çš„ä»£ç ï¼Œæ¥è‡ªäº<a target="_blank" rel="noopener" href="http://osteele.com/">Oliver Steele</a> ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Returns a function that takes an object, and returns the value of its &#x27;name&#x27; property</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> pluck = <span class="keyword">function</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span>(<span class="params">object</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> object[name];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span> getLength = <span class="title function_">pluck</span>(<span class="string">&#x27;length&#x27;</span>);</span><br><span class="line"><span class="title function_">getLength</span>(<span class="string">&quot;SF Giants are going to the World Series!&quot;</span>); <span class="comment">//40</span></span><br></pre></td></tr></table></figure>
<h3 id="æ¨¡å—åŒ–æ¨¡å¼"><a href="#æ¨¡å—åŒ–æ¨¡å¼" class="headerlink" title="æ¨¡å—åŒ–æ¨¡å¼"></a>æ¨¡å—åŒ–æ¨¡å¼</h3><p>è¿™æ˜¯ä¸ª<a target="_blank" rel="noopener" href="https://javascriptweblog.wordpress.com/2010/04/22/the-module-pattern-in-a-nutshell/">å¹¿ä¸ºäººçŸ¥çš„æŠ€æœ¯</a>ï¼Œå®ƒä½¿ç”¨é—­åŒ…ç»´æŠ¤äº†ä¸€ä¸ªç§æœ‰çš„ã€ç‹¬å çš„å¯¹å¤–å±‚åŸŸä¸­å˜é‡çš„å¼•ç”¨ã€‚è¿™é‡Œæˆ‘ç”¨æ¨¡å—åŒ–æ¨¡å¼å®ç°äº†ä¸€ä¸ªâ€œçŒœæ•°å­—â€æ¸¸æˆã€‚æ³¨æ„åœ¨æ­¤ä¾‹ä¸­ï¼Œé—­åŒ…ï¼ˆ<em>guess</em>ï¼‰ä¸ <em>secretNumber</em> å˜é‡æœ‰ç€å”¯ä¸€çš„è”ç³»ï¼Œè€Œ <em>responses</em> å¯¹è±¡åˆ™åªåœ¨åˆ›å»ºæ—¶ä½¿ç”¨äº†å®ƒçš„å€¼ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> secretNumberGame = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> secretNumber = <span class="number">21</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">responses</span>:&#123;</span><br><span class="line">      <span class="attr">true</span>: <span class="string">&quot;You are correct! Answer is &quot;</span> + secretNumber,</span><br><span class="line">      <span class="attr">lower</span>: <span class="string">&quot;Too high!&quot;</span>,</span><br><span class="line">      <span class="attr">higher</span>: <span class="string">&quot;Too low!&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    </span><br><span class="line">    <span class="attr">guess</span>: <span class="keyword">function</span>(<span class="params">guess</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> key = (guess == secretNumber) || (guess &lt; secretNumber ? <span class="string">&quot;higher&quot;</span> : <span class="string">&quot;lower&quot;</span>);</span><br><span class="line">      <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">responses</span>[key]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> game = <span class="title function_">secretNumberGame</span>();</span><br><span class="line">game.<span class="title function_">guess</span>(<span class="number">45</span>); <span class="comment">//&quot;Too high!&quot;</span></span><br><span class="line">game.<span class="title function_">guess</span>(<span class="number">18</span>); <span class="comment">//&quot;Too low!&quot;</span></span><br><span class="line">game.<span class="title function_">guess</span>(<span class="number">21</span>); <span class="comment">//&quot;You are correct! Answer is 21&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åœ¨ç¼–ç¨‹æœ¯è¯­ä¸­ï¼Œé—­åŒ…ä»£è¡¨äº†ä¼˜é›…å’Œç²¾è‡´ã€‚å®ƒä½¿å¾—ä»£ç æ›´ç®€æ´æ¼‚äº®ã€å¯è¯»æ€§æ›´é«˜ï¼ŒåŒæ—¶æå‡äº†ä»£ç çš„é‡ç”¨æ€§ã€‚äº†è§£é—­åŒ…çš„å·¥ä½œåŸç†ï¼Œå°±å¯ä»¥é¿å…ä½¿ç”¨ä¸­çš„ä¸ç¡®å®šæ€§ã€‚æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½å¤Ÿå¸®åˆ°ä½ ï¼Œå¦‚æœæœ‰é—®é¢˜ã€æƒ³æ³•æˆ–å…¶å®ƒäº‹ï¼Œéƒ½è¯·ç•™ä¸‹æ‚¨çš„è¯„è®ºã€‚</p>
<h2 id="è¿›ä¸€æ­¥çš„é˜…è¯»"><a href="#è¿›ä¸€æ­¥çš„é˜…è¯»" class="headerlink" title="è¿›ä¸€æ­¥çš„é˜…è¯»"></a>è¿›ä¸€æ­¥çš„é˜…è¯»</h2><p><a target="_blank" rel="noopener" href="http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-262.pdf">ECMA-262 5th Edition</a></p>
<ul>
<li>10.4 åˆ›å»ºå˜é‡ç¯å¢ƒ</li>
<li>10.4.3.5-7 åœ¨å˜é‡ç¯å¢ƒä¸­å¼•ç”¨ [[scope]] å±æ€§</li>
<li>10.5 å¡«å…¥å˜é‡ç¯å¢ƒ</li>
<li>13.0-2 å‡½æ•°åˆ›å»ºæ—¶ä¸º [[scope]] å±æ€§èµ‹å€¼</li>
</ul>
<blockquote>
<p>ç¿»è¯‘è‡ªï¼š<a target="_blank" rel="noopener" href="https://javascriptweblog.wordpress.com/2010/10/25/understanding-javascript-closures/">Understanding Javascript Closures</a></p>
</blockquote>

      

      
        
    </div>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/10/13/build-todo-app/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          ä½¿ç”¨ Redux ç§’åš todo-list åº”ç”¨
        
      </div>
    </a>
  
  
    <a href="/2016/07/01/PHP-Coroutine/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">ç”¨PHPåç¨‹å®ç°å¤šä»»åŠ¡åä½œ</div>
    </a>
  
</nav>

  
</article>

<script type='text/javascript'>window.notIndexPage = true;</script>


<section id="comments">
  <div id="disqus_thread">
    <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'imzvz'; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>
    Please enable JavaScript to view the <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
    </noscript>
  </div>
</section>
</section>
        <aside id="sidebar">
  <nav class="menus">
  	<ul>
  		<li><a href="/"><i class="icon icon-home"></i></a></li>
  		
			<li><a href="/archives"><i class="icon icon-fenlei"></i></a></li>
  		
  		
			<li><a href="/tags"><i class="icon icon-tag"></i></a></li>
  		
  		
  	</ul>
  </nav>
  <a id="go-top" href="#"><i class="icon icon-up"></i></a>
</aside>
      </div>
      <footer id="footer">
  
	<div id="footer-info" class="inner">
	Linked with:&nbsp;&nbsp;&nbsp; 
	<a href="http://mritd.me" target="_blank">mritd.me</a>&nbsp;&nbsp;&nbsp;
	<a href="https://www.mghio.cn" target="_blank">mghio's blog</a>&nbsp;&nbsp;&nbsp;
	<a href="https://sillydong.com" target="_blank">å‚»ä¸œã®å­¦ä¹ ç¬”è®°</a>&nbsp;&nbsp;&nbsp;
	</div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/tags" class="mobile-nav-link">Tag</a>
  
</nav>
    
<script>
  var disqus_shortname = 'imzvz';
  
  var disqus_url = 'http://zvz.im/2016/09/03/understand-js-closure/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script>

<script>
  if(window.notIndexPage)
  $(function(){
    $.get('//manage.zvz.im/api/posts/adv', function(res) {
      if(res.data.length) {
        $.each(res.data, function(idx, adv) {
          if(idx == 0) {
            if($('h2:first').length > 0) {
              $(adv).insertBefore('h2:first');
              return;
            }
          }
          $(adv).insertAfter('.article-inner');
        });
      }
    });
  });
</script>



  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/require.min.js"></script>


<script src="/js/script.js"></script>



<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>



  </div><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({{ JSON.stringify(config) }});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="{{ src }}">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>